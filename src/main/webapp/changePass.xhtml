<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="jakarta.faces.html"
      xmlns:f="jakarta.faces.core"
      xmlns:p="http://primefaces.org/ui">
<h:head>
    <title>パスワード変更</title>
    <meta charset="UTF-8" />
</h:head>
<script>
function checkPassword(){
    const newpass = document.getElementById("chgPassForm:newPass").value;
    const confirm = document.getElementById("chgPassForm:confirmPass").value;
    const msg = document.getElementById("chgPassForm:msg");
    if (newpass !== confirm){
        msg.innerHTML = "パスワードが一致しません";
        return false;
    }else{
        msg.innerHTML = "";
        return true;
    }
}
</script>
<h:body>
    <h2>パスワード変更</h2>
    <h:form id="chgPassForm">
        <h:panelGrid columns="2">
            <h:outputLabel value="現在のパスワード:" />
            <p:password id="currentPassword" value="#{loginUser.currentPassword}" toggleMask="true"/>

            <h:outputLabel value="新しいパスワード:" />
            <p:password id="newPass" value="#{loginUser.newPassword}" toggleMask="true"/>

            <h:outputLabel value="確認パスワード:" />
            <p:password id="confirmPass" value="#{loginUser.confirmPassword}" toggleMask="true"/>

            <h:inputHidden id="uid" value="#{loginUser.user.id}" />
            
        </h:panelGrid>

        <p:commandButton value="変更" action="#{loginUser.changePassword}" update="messages" onclick="return checkPassword();" />
        <h:commandButton value="キャンセル" action="profile.xhtml" />
    </h:form>
    <!-- メッセージ表示 -->
    <h:outputText id="msg" value="" style="color:red;" />
    <h:messages id="messages" globalOnly="true" style="color:green;" />
</h:body>
</html>
